# DFV Artifact

This is the artifact to accompany the ASE technical track submission "Distribution Models for Falsification and Verification of DNNs".

Due to the size of trained models, we could not include them in this repository. The trained models used to evaluate DFV are available here: https://drive.google.com/drive/folders/1EPA-QaDw8SlpjAHLO4uT7WWdABIBLPtu

The artifact is split into several directories.

- Directory `rq3` contains the code and data from our experiments for research question 3. The environment models used to evaluate DFV are available in the `RQ3 Models` directory at https://drive.google.com/drive/folders/1EPA-QaDw8SlpjAHLO4uT7WWdABIBLPtu.

## RQ1

## RQ2

## RQ3

To run the code for RQ3, first change into the `rq3` directory and run `./install.sh`. This will set up a python virtual environment and install the necessary dependencies. After install, run `source .venv/bin/activate` to activate the virtual environment.

Environment models can then be trained by running `./train_fc.py` to train FC-*VAE_{DroNet}*, `./train_vae.py` to train Conv-*VAE_{DroNet}*, and `./train_dcgan.py` to train *GAN_{DroNet}*.

The PGD falsifier can then be run on the DroNet network, both without DFV and with DFV using the VAE and GAN models by running `./falsify.sh`. By default this script will run all 3 methods. A specific treatment can be specified by passing `dnn`, `vae`, or `gan` as the first argument to this script. If the first argument is `all` then all treatments will be run. This script will save all counter-examples to the directory `cex/`. The second argument to `./falsify.sh` can be used to specify a different name for this directory. The third and final argument accepted by this script specifies a timeout for each job in seconds. By default this timeout is 1 hour, or 3600 seconds.

After running the falsifier, counter-examples can be converted to png formatted images and the plots for the paper can be generated by running `python npy_to_png.py cex logs`.
